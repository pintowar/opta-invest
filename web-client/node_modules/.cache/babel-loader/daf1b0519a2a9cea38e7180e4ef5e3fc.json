{"remainingRequest":"/home/thiago/Projects/code/opta-invest/client/node_modules/babel-loader/lib/index.js!/home/thiago/Projects/code/opta-invest/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/thiago/Projects/code/opta-invest/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/thiago/Projects/code/opta-invest/client/src/components/portfolio/allocation.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/thiago/Projects/code/opta-invest/client/src/components/portfolio/allocation.vue","mtime":1597275656826},{"path":"/home/thiago/Projects/code/opta-invest/client/node_modules/cache-loader/dist/cjs.js","mtime":1589656986742},{"path":"/home/thiago/Projects/code/opta-invest/client/node_modules/babel-loader/lib/index.js","mtime":1589656986733},{"path":"/home/thiago/Projects/code/opta-invest/client/node_modules/cache-loader/dist/cjs.js","mtime":1589656986742},{"path":"/home/thiago/Projects/code/opta-invest/client/node_modules/vue-loader/lib/index.js","mtime":1597019925514}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBSYWluYm93IGZyb20gJ2NvbG9yLXJhaW5ib3cnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgQWxsb2NhdGlvbkNoYXJ0IGZyb20gJ0AvY29tcG9uZW50cy9wb3J0Zm9saW8vY2hhcnQudnVlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdhbGxvY2F0aW9uJywKICBwcm9wczogWyd0aXRsZScsICdwb3J0Zm9saW8nLCAnc3RhdHVzJ10sCiAgY29tcG9uZW50czogewogICAgJ2FsbG9jYXRpb24tY2hhcnQnOiBBbGxvY2F0aW9uQ2hhcnQKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0YWJsZUZpZWxkczogWydhc3NldCcsICdleHBlY3RlZFJldHVybicsICdzdGFuZGFyZERldmlhdGlvbicsICdxdWFudGl0eUxhYmVsJ10KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgc29sdmluZzogZnVuY3Rpb24gc29sdmluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhdHVzID09PSAnU09MVklOR19BQ1RJVkUnOwogICAgfSwKICAgIHBhcmFtZXRyaXphdGlvbjogewogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChuZXdWYWwpIHsKICAgICAgICB0aGlzLnBvcnRmb2xpby5wYXJhbWV0cml6YXRpb24uc3RhbmRhcmREZXZpYXRpb25NYXhpbXVtTGFiZWwgPSAiIi5jb25jYXQobmV3VmFsLCAiJSIpOwogICAgICAgIHRoaXMucG9ydGZvbGlvLnBhcmFtZXRyaXphdGlvbi5zdGFuZGFyZERldmlhdGlvbk1pbGxpc01heGltdW0gPSBuZXdWYWwgKiAxMDsKICAgICAgfSwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICgoKHRoaXMucG9ydGZvbGlvIHx8IHt9KS5wYXJhbWV0cml6YXRpb24gfHwge30pLnN0YW5kYXJkRGV2aWF0aW9uTWlsbGlzTWF4aW11bSB8fCAwKSAvIDEwOwogICAgICB9CiAgICB9LAogICAgYWxsb2NhdGlvbnM6IGZ1bmN0aW9uIGFsbG9jYXRpb25zKCkgewogICAgICB2YXIgYXNzZXRzTGlzdCA9IHRoaXMucG9ydGZvbGlvID8gdGhpcy5wb3J0Zm9saW8uYXNzZXRDbGFzc0xpc3QgOiBbXTsKICAgICAgdmFyIGFzc2V0c0lkID0gKGFzc2V0c0xpc3QgfHwgW10pLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBlKSB7CiAgICAgICAgYWNjW2UuaWRdID0gZTsKICAgICAgICByZXR1cm4gYWNjOwogICAgICB9LCB7fSk7CiAgICAgIHJldHVybiAodGhpcy5wb3J0Zm9saW8uYXNzZXRDbGFzc0FsbG9jYXRpb25MaXN0IHx8IFtdKS5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgYXNzZXQ6IGFzc2V0c0lkW2UuYXNzZXRDbGFzc0lkXS5uYW1lLAogICAgICAgICAgZXhwZWN0ZWRSZXR1cm46IGFzc2V0c0lkW2UuYXNzZXRDbGFzc0lkXS5leHBlY3RlZFJldHVybkxhYmVsLAogICAgICAgICAgc3RhbmRhcmREZXZpYXRpb246IGFzc2V0c0lkW2UuYXNzZXRDbGFzc0lkXS5zdGFuZGFyZERldmlhdGlvblJpc2tMYWJlbCwKICAgICAgICAgIHF1YW50aXR5TWlsbGlzOiBlLnF1YW50aXR5TWlsbGlzLAogICAgICAgICAgcXVhbnRpdHlMYWJlbDogZS5xdWFudGl0eUxhYmVsCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9LAogICAgY2hhcnRBbGxvY2F0aW9uczogZnVuY3Rpb24gY2hhcnRBbGxvY2F0aW9ucygpIHsKICAgICAgdmFyIGNvbG9ycyA9IFJhaW5ib3cuY3JlYXRlKHRoaXMuYWxsb2NhdGlvbnMubGVuZ3RoKS5tYXAoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gInJnYigiLmNvbmNhdChjLnZhbHVlcy5yZ2Iuam9pbignLCAnKSwgIikiKTsKICAgICAgfSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgbGFiZWxzOiB0aGlzLmFsbG9jYXRpb25zLm1hcChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuYXNzZXQ7CiAgICAgICAgfSksCiAgICAgICAgZGF0YXNldHM6IFt7CiAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGNvbG9ycywKICAgICAgICAgIGRhdGE6IHRoaXMuYWxsb2NhdGlvbnMubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHJldHVybiBlLnF1YW50aXR5TWlsbGlzOwogICAgICAgICAgfSkKICAgICAgICB9XQogICAgICB9OwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgcGFyYW1ldHJpemF0aW9uQ2hhbmdlOiBmdW5jdGlvbiBwYXJhbWV0cml6YXRpb25DaGFuZ2UoKSB7CiAgICAgIHZhciBhdXggPSBwYXJzZUZsb2F0KHRoaXMucGFyYW1ldHJpemF0aW9uKTsKICAgICAgdmFyIHF0eSA9IE1hdGgubWF4KE1hdGgubWluKGlzTmFOKGF1eCkgPyAwLjAgOiBhdXgsIDEwMC4wKSwgMC4wKTsKICAgICAgdGhpcy5wYXJhbWV0cml6YXRpb24gPSBxdHk7CiAgICB9LAogICAgYWxsb2NhdGVBc3NldHM6IGZ1bmN0aW9uIGFsbG9jYXRlQXNzZXRzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHVybCA9ICIvYXBpL3BvcnRmb2xpby8iLmNvbmNhdCh0aGlzLnBvcnRmb2xpby5pZCwgIi9hc3luYy1hbGxvY2F0ZSIpOwogICAgICBheGlvcy5wb3N0KHVybCwgdGhpcy5wb3J0Zm9saW8pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzLiRlbWl0KCduZXdTdGF0dXMnLCByZXMuZGF0YSk7CgogICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIHRlcm1pbmF0ZUFsbG9jYXRpb246IGZ1bmN0aW9uIHRlcm1pbmF0ZUFsbG9jYXRpb24oKSB7CiAgICAgIHZhciB1cmwgPSAiL2FwaS9wb3J0Zm9saW8vIi5jb25jYXQodGhpcy5wb3J0Zm9saW8uaWQsICIvdGVybWluYXRlIik7CiAgICAgIGF4aW9zLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["allocation.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"assets\">\n    <b-row>\n      <h1>{{ title }}</h1>\n    </b-row>\n    <b-row>\n      <b-form>\n        <b-button size=\"sm\" variant=\"success\" @click=\"allocateAssets\">Allocate Assets</b-button>\n        <b-button size=\"sm\" variant=\"danger\" @click=\"terminateAllocation\">Terminate Allocation</b-button>\n        <b-badge pill variant=\"primary\">{{ status }}</b-badge>\n      </b-form>\n    </b-row>\n    <b-row>\n      <b-col cols=\"6\">\n        <b-container fluid>\n          <b-row>\n            <b-col sm=\"6\">\n              <label for=\"input-std\">Maximum Standard Deviation:</label>\n            </b-col>\n            <b-col sm=\"3\">\n              <b-input-group size=\"sm\" append=\"%\">\n                <b-form-input id=\"input-std\" v-model.trim=\"parametrization\" @change=\"parametrizationChange\" type=\"number\" :disabled=\"solving\"/>\n              </b-input-group>\n            </b-col>\n          </b-row>\n        </b-container>\n        <b-table striped hover :items=\"allocations\" :fields=\"tableFields\"/>\n        <p>\n          Expected Return: <b>{{ (portfolio || {}).expectedReturnLabel }}</b>,\n          Standard Deviation Risk: <b>{{ (portfolio || {}).standardDeviationLabel }}</b>\n        </p>\n      </b-col>\n      <b-col cols=\"6\">\n          <allocation-chart :chart-data=\"chartAllocations\"/>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\nimport Rainbow from 'color-rainbow'\nimport axios from 'axios'\nimport AllocationChart from '@/components/portfolio/chart.vue'\n\nexport default {\n  name: 'allocation',\n  props: ['title', 'portfolio', 'status'],\n  components: {\n    'allocation-chart': AllocationChart\n  },\n  data () {\n    return {\n      tableFields: ['asset', 'expectedReturn', 'standardDeviation', 'quantityLabel']\n    }\n  },\n  computed: {\n    solving () {\n      return this.status === 'SOLVING_ACTIVE'\n    },\n    parametrization: {\n      set (newVal) {\n        this.portfolio.parametrization.standardDeviationMaximumLabel = `${newVal}%`\n        this.portfolio.parametrization.standardDeviationMillisMaximum = newVal * 10\n      },\n      get () {\n        return (((this.portfolio || {}).parametrization || {}).standardDeviationMillisMaximum || 0) / 10\n      }\n    },\n    allocations () {\n      const assetsList = this.portfolio ? this.portfolio.assetClassList : []\n      const assetsId = (assetsList || []).reduce((acc, e) => { acc[e.id] = e; return acc }, {})\n\n      return (this.portfolio.assetClassAllocationList || []).map(e => ({\n        asset: assetsId[e.assetClassId].name,\n        expectedReturn: assetsId[e.assetClassId].expectedReturnLabel,\n        standardDeviation: assetsId[e.assetClassId].standardDeviationRiskLabel,\n        quantityMillis: e.quantityMillis,\n        quantityLabel: e.quantityLabel}))\n    },\n    chartAllocations () {\n      const colors = Rainbow.create(this.allocations.length).map(c => `rgb(${c.values.rgb.join(', ')})`)\n      return {\n        labels: this.allocations.map(e => e.asset),\n        datasets: [{\n          backgroundColor: colors,\n          data: this.allocations.map(e => e.quantityMillis)\n        }]\n      }\n    }\n  },\n  methods: {\n    parametrizationChange () {\n      const aux = parseFloat(this.parametrization)\n      const qty = Math.max(Math.min(isNaN(aux) ? 0.0 : aux, 100.0), 0.0)\n      this.parametrization = qty\n    },\n    allocateAssets () {\n      const url = `/api/portfolio/${this.portfolio.id}/async-allocate`\n      axios.post(url, this.portfolio)\n      .then(res => {\n        this.$emit('newStatus', res.data)\n        console.log(res.data)\n      }, error => {\n        console.error(error)\n      })\n    },\n    terminateAllocation () {\n      const url = `/api/portfolio/${this.portfolio.id}/terminate`\n      axios.get(url)\n      .then(res => {\n        console.log(res.data)\n      }, error => {\n        console.error(error)\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/components/portfolio"}]}